const dcc = require("./dcc.js");

// AT Acceptance
let hcert1 = "HC1:NCFTW2H:7*I06R3W/J:O6:P4QB3+7RKFVJWV66UBCE//UXDT:*ML-4D.NBXR+SRHMNIY6EB8I595+6UY9-+0DPIO6C5%0SBHN-OWKCJ6BLC2M.M/NPKZ4F3WNHEIE6IO26LB8:F4:JVUGVY8*EKCLQ..QCSTS+F$:0PON:.MND4Z0I9:GU.LBJQ7/2IJPR:PAJFO80NN0TRO1IB:44:N2336-:KC6M*2N*41C42CA5KCD555O/A46F6ST1JJ9D0:.MMLH2/G9A7ZX4DCL*010LGDFI$MUD82QXSVH6R.CLIL:T4Q3129HXB8WZI8RASDE1LL9:9NQDC/O3X3G+A:2U5VP:IE+EMG40R53CG9J3JE1KB KJA5*$4GW54%LJBIWKE*HBX+4MNEIAD$3NR E228Z9SS4E R3HUMH3J%-B6DRO3T7GJBU6O URY858P0TR8MDJ$6VL8+7B5$G CIKIPS2CPVDK%K6+N0GUG+TG+RB5JGOU55HXDR.TL-N75Y0NHQTZ3XNQMTF/ZHYBQ$8IR9MIQHOSV%9K5-7%ZQ/.15I0*-J8AVD0N0/0USH.3";
let certificate = dcc.decode(hcert1);
console.log('\n\n');
console.log('//\n// Decode EU-DCC\n//');
console.log(certificate);

// kid: 2Rk3X8HntrI=
// https://dgcg-qa.covidbevis.se/tp/
const pemAccAT = `-----BEGIN CERTIFICATE-----
MIIBvTCCAWOgAwIBAgIKAXk8i88OleLsuTAKBggqhkjOPQQDAjA2MRYwFAYDVQQDDA1BVCBER0MgQ1NDQSAxMQswCQYDVQQGEwJBVDEPMA0GA1UECgwGQk1TR1BLMB4XDTIxMDUwNTEyNDEwNloXDTIzMDUwNTEyNDEwNlowPTERMA8GA1UEAwwIQVQgRFNDIDExCzAJBgNVBAYTAkFUMQ8wDQYDVQQKDAZCTVNHUEsxCjAIBgNVBAUTATEwWTATBgcqhkjOPQIBBggqhkjOPQMBBwNCAASt1Vz1rRuW1HqObUE9MDe7RzIk1gq4XW5GTyHuHTj5cFEn2Rge37+hINfCZZcozpwQKdyaporPUP1TE7UWl0F3o1IwUDAOBgNVHQ8BAf8EBAMCB4AwHQYDVR0OBBYEFO49y1ISb6cvXshLcp8UUp9VoGLQMB8GA1UdIwQYMBaAFP7JKEOflGEvef2iMdtopsetwGGeMAoGCCqGSM49BAMCA0gAMEUCIQDG2opotWG8tJXN84ZZqT6wUBz9KF8D+z9NukYvnUEQ3QIgdBLFSTSiDt0UJaDF6St2bkUQuVHW6fQbONd731/M4nc=
-----END CERTIFICATE-----`;


// kid: FhciF/j3plg=
// https://dgcg.covidbevis.se/tp/
const pemProdUA = `-----BEGIN CERTIFICATE-----
MIIEuzCCBGGgAwIBAgIUeQTIILWQh4cEAAAAFgAAACEAAAAwCgYIKoZIzj0EAwIw
gZsxIDAeBgNVBAoMF1N0YXRlIGVudGVycHJpc2UgIkRJSUEiMScwJQYDVQQDDB4i
RElJQSIuIEdyZWVuIENlcnRpZmljYXRlIENTQ0ExGTAXBgNVBAUTEFVBLTQzMzk1
MDMzLTIwMjExCzAJBgNVBAYTAlVBMQ0wCwYDVQQHDARLeWl2MRcwFQYDVQRhDA5O
VFJVQS00MzM5NTAzMzAeFw0yMTA4MTcyMTAwMDBaFw0yMzA4MTcyMDU5NTlaMHUx
IDAeBgNVBAoMF1N0YXRlIGVudGVycHJpc2UgIkRJSUEiMSgwJgYDVQQDDB8iRElJ
QSIuIEdyZWVuIENlcnRpZmljYXRlIERTQyAyMQswCQYDVQQFEwIyMjELMAkGA1UE
BhMCVUExDTALBgNVBAcMBEt5aXYwWTATBgcqhkjOPQIBBggqhkjOPQMBBwNCAAR3
bbO3noNDHVqjl13i7qNTco8Qsl1xZ+XT4UnpxWEJvyzRKZCV4W1L2blFCpXNsGv8
mdR+pVmO+s8XPCluB0x5o4ICpjCCAqIwHQYDVR0OBBYEFIjv6MDr8gqaj1GvhYEN
J5FvDg+LMB8GA1UdIwQYMBaAFHkEyCC1kIeHDT09MC0K0Ko+YXcCMA4GA1UdDwEB
/wQEAwIGwDAzBgNVHSUELDAqBgwrBgEEAQCON49lAQEGDCsGAQQBAI43j2UBAgYM
KwYBBAEAjjePZQEDMEEGA1UdIAQ6MDgwNgYJKoYkAgEBAQICMCkwJwYIKwYBBQUH
AgEWG2h0dHBzOi8vZ3JlZW5jYS5kaWlhLmdvdi51YTAJBgNVHRMEAjAAMFQGCCsG
AQUFBwEDBEgwRjAIBgYEAI5GAQEwLQYGBACORgEFMCMwIRYbaHR0cHM6Ly9ncmVl
bmNhLmRpaWEuZ292LnVhEwJlbjALBgkqhiQCAQEBAgEwTgYDVR0fBEcwRTBDoEGg
P4Y9aHR0cDovL2dyZWVuY2EuZGlpYS5nb3YudWEvZG93bmxvYWQvY3Jscy9DQS03
OTA0QzgyMC1GdWxsLmNybDBPBgNVHS4ESDBGMESgQqBAhj5odHRwOi8vZ3JlZW5j
YS5kaWlhLmdvdi51YS9kb3dubG9hZC9jcmxzL0NBLTc5MDRDODIwLURlbHRhLmNy
bDCBiQYIKwYBBQUHAQEEfTB7MDUGCCsGAQUFBzABhilodHRwOi8vZ3JlZW5jYS5k
aWlhLmdvdi51YS9zZXJ2aWNlcy9vY3NwLzBCBggrBgEFBQcwAoY2aHR0cDovL2dy
ZWVuY2EuZGlpYS5nb3YudWEvY2EtY2VydGlmaWNhdGVzL2dyZWVuY2EucDdiMEoG
CCsGAQUFBwELBD4wPDA6BggrBgEFBQcwA4YuaHR0cDovL2dyZWVuY2EuZGlpYS5n
b3YudWEvc2VydmljZXMvdHNwL2VjZHNhLzAKBggqhkjOPQQDAgNIADBFAiEAzrDX
xTuym77Eo9J4GNB/GoZRm9lTVtmUpLCjhzr7t5ICIDdt0waoDoBfm201AGoLjEr
sage0uxBI3SkncWQaP7nZ
-----END CERTIFICATE-----`

const pemWork = `-----BEGIN CERTIFICATE-----
MIIBYDCCAQUCEENfLudoRwi3Bk6KmNgzunswCgYIKoZIzj0EAwIwMjEjMCEGA1UE
AwwaTmF0aW9uYWwgQ1NDQSBvZiBGcmllc2xhbmQxCzAJBgNVBAYTAkZSMB4XDTIy
MDIwMjE2NTYyNloXDTI2MTIxODE2NTYyNlowNjEnMCUGA1UEAwweRFNDIG51bWJl
ciB3b3JrZXIgb2YgRnJpZXNsYW5kMQswCQYDVQQGEwJGUjBZMBMGByqGSM49AgEG
CCqGSM49AwEHA0IABARxvLqXY+lOCg4orWNvoS5Ap3df1EYySle4+TUT2187uDuG
DomY/TAFr0ZW4J3BoZIA1oxFkRr7A/Zzv2rbTjwwCgYIKoZIzj0EAwIDSQAwRgIh
AK/Ll9M0jmYCZbVxHQ14cL3Au4WeORwj8bixgkzbPZpxAiEAii+BN0gQ4UNTjRmg
Ak4b1fIXmTR6y3rTKl3LlQchrug=
-----END CERTIFICATE-----`

const pem = pemAccAT;

// UA
const hcert2 = `HC1:NCFGZA:9QMWQX23IOEE*3B%3GSI7Q1L 7J%235MIJFZW1ROKC$G8XHFXCP7JI 9 XKIVPHTF6UV9A6L%T *MF1P1NEJ688WM8TGL+E6:PRH41NR1GSM:1ZOLXMU8-L*02-BF*BT:3KM-FS3OM6IY7J4A9B0RZ4S70OZAOD93MGN:0R:S9BG4O35F-HDEV$XOX:O6GI4%ERHIYW5QJLBPPFH0HL5R-B7RL4QJKV9EF04VAW3A0R9AFKT9J/J8SR4I5A0G9NJC-0H-EJK2EQL3UI4YCO4.FTGRQ 4NTUJC3OBMF4S1APYAGJ-O27GDF2UG6F23AKL:3NWF7$/5NJN/-4GJE 85C1ILTA3-5 IE98P6VBADIJYDBF37UJY0HHP8JFPQB0W50VZBSYPZOE5W6.RG.KU$ V+I1T63:50NQD3-3OX6K8OMEO2K3OF72:BP$4LAFFX46P1%K1:1JQH7KGQG1TXJM:$5F22E6L0:ERT7EE9$-5T.5H3P7WQ $EBQOSMB3UM3V835I YV:FRO7D3PSD3LWAWO+P LVF0J.XA7+2EV3:4H4UC/CWJ3VL6WHVAO-GC44Z9IWBS:EJXS0GYA%S9V%HH/SQF57BF/ 8+MD CD.$IJ2HI77L17O6QWMQ$TDVPD-TQ..HQRPI/T/YQF82.AN-M5L+E4 D068MQQDAPFKPA2GBRU3*AGCM2OEB+DLKTIKJ-FPD$7A8T%/UH9PWZOE9J*+74YG/V7NQQYUNG6M9UN$*A28L9/V+3F84RI GOAT+%D/.MB9NB:PA18A60T4T+4`
// SK
const hcert3 = `HC1:NCFOXN%TSMAHN-HTXOGLDP.UK0TETN1V8H%BZEJP-SXG4U*QOGOM*4$9E%$CCV4*XUA2PSGH.+H$NI4L6F$SYQ1*VBKMG5YBKB0D:RX-F*0S*C0B*FSM8MX7.O3J*FNSG:PIWIG4SI4UUIMI.J9WVHWVH+ZE/T9$%HVLI+QHZ/JZ/JW%F72SJ-J/IE%TE6UG+ZEAT1HQ1NFGSU9ZIEQKERQ8IY1I$HH%U8 9PS5-LH/CJTK96L6SR9MU9DV5 R13PI%F1PN1/T1%%HN9GL$UP$I/XK$M8GPE6YBAN8UP8B-S-*O5W41FDCHD9PVYGFF.O9NT OTOX45 C-PV KP8EFCHDP8WE0GJMO9NTUZ4VIO::HJF8JMOF%CD 810H% 0V.G8*1N+610509BM5B+:GJ1U+$J9CV  UO7N8AT%VUD6D9 LVO5 .UG*TQZLMXP*QG9Z7. VU$1BK6NSJKHEXGJC0T7FB0/OBQ89J58+FJ60+08Q3`
try {
    const certificate = dcc.verify(hcert1, pem);
    console.log('\n\n');
    console.log('//\n// Decode EU-DCC and Verify Signature\n//');
    console.log(certificate)
    console.error('>>> Signature Verified! <<<');
} catch (error) {
    console.error('Verification failed: ', error.message);
}
